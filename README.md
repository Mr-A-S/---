# Классификация аритмий сердца по сигналам ЭКГ с помощью 1D CNN

### Выпускная квалификационная работа

---

## Обзор проекта

Данный репозиторий содержит исходный код и артефакты, полученные в ходе выполнения выпускной квалификационной работы на тему **"Подготовка и предварительная обработка данных предметной области для модели распознавания вариант 714"**.

Проект представляет собой реализацию и исследование полного конвейера машинного обучения для автоматической диагностики 5 классов сердечных сокращений (согласно стандарту AAMI) по одномерным сигналам электрокардиограммы (ЭКГ). В качестве основной архитектуры была выбрана глубокая одномерная сверточная нейронная сеть (1D CNN) с механизмом внимания (Attention).

Итоговая модель, обученная на объединенном наборе данных из **MIT-BIH Arrhythmia Database** и **PTB-XL ECG dataset**, достигла **`macro average F1-score` 0.46** и общей точности **68%** на независимой тестовой выборке, разделенной по пациентам.

---

## Структура репозитория

Репозиторий содержит Jupyter-ноутбук, который представляет собой последовательные этапы работы над проектом.

### `ECG_Arrhythmia_Classification.ipynb`

Этот ноутбук содержит основную часть работы, включая полный цикл от загрузки данных до обучения и финальной оценки.

**Содержание ноутбука:**

*   **Подготовка среды:** Установка необходимых библиотек (`wfdb`, `biosppy`, `imblearn`) и настройка Kaggle API.
*   **Загрузка и предобработка данных:**
    *   Загрузка и парсинг двух датасетов: **MIT-BIH Arrhythmia Database** и **PTB-XL ECG dataset**.
    *   Сегментация непрерывных записей на отдельные сердечные сокращения, центрированные по R-пику.
    *   Нормализация и приведение всех сегментов к единой длине.
*   **Разделение данных:** Реализовано строгое разделение данных на обучающую, валидационную и тестовую выборки **по уникальным идентификаторам пациентов**, чтобы избежать утечки данных и обеспечить честную оценку модели.
*   **Балансировка классов:** Для борьбы с сильным дисбалансом классов применен комбинированный подход:
    *   **Undersampling:** Контролируемое уменьшение количества примеров доминирующего класса 'N'.
    *   **Class Weights:** Использование весовых коэффициентов для классов в функции потерь во время обучения.
*   **Обучение модели:**
    *   Реализована и обучена глубокая 1D CNN с механизмом **Attention** и аугментацией **GaussianNoise** на лету.
    *   Использованы колбэки `EarlyStopping` и `ReduceLROnPlateau` для предотвращения переобучения и автоматической настройки скорости обучения.
*   **Оценка и анализ ошибок:**
    *   Оценка лучшей модели на отложенной тестовой выборке.
    *   Построение и анализ **матрицы ошибок** и отчета о классификации (`classification_report`).
    *   Визуализация кривых обучения (точность и потери).

---

## Использованные технологии и библиотеки

*   **Python 3.x**
*   **TensorFlow 2.x / Keras** (для построения и обучения нейронной сети)
*   **Scikit-learn** (для метрик, разделения данных и весов классов)
*   **Imbalanced-learn** (для техник сэмплинга)
*   **Pandas** (для работы с метаданными)
*   **Matplotlib / Seaborn** (для визуализации)
*   **WFDB-python** (для работы с сигналами и аннотациями в формате PhysioNet)
*   **Biosppy** (для R-пик детекции)
*   **Kaggle API** (для загрузки данных)
*   **Google Colaboratory** (среда для обучения с аппаратным ускорителем GPU)

---

## Как воспроизвести результаты

1.  Клонируйте репозиторий.
2.  Создайте файл `kaggle.json` с вашим API-ключом Kaggle.
3.  Откройте ноутбук `ВКР_ЦК.ipynb` в среде Google Colab.
4.  Включите аппаратный ускоритель **GPU** (Среда выполнения -> Сменить среду выполнения -> GPU).
5.  Следуйте инструкциям в ячейках ноутбука для загрузки API-ключа и датасетов.
6.  Выполняйте ячейки последовательно. Процесс загрузки и подготовки данных может занять некоторое время.
